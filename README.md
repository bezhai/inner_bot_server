# Inner Bot Server

一个简单好用的飞书机器人服务，支持智能对话、图片搜索和群组管理功能。

## ✨ 功能特点

- **🤖 智能对话**：基于AI模型的流式对话，支持工具调用
- **🎨 媒体搜索**：Pixiv图片搜索、表情包生成
- **👥 群组功能**：复读检测、消息统计、权限管理
- **⏰ 定时任务**：自动下载Pixiv作品、同步Bangumi数据、每日照片推送
- **🔧 简单部署**：Docker容器化，一键启动

## 🚀 快速部署

详见 [部署指南](docs/deployment.md)

## 🏗️ 服务架构

```
┌─────────────────┐    ┌─────────────────┐
│   飞书机器人     │    │   Web界面       │
└─────────────────┘    └─────────────────┘
         │                       │
         ▼                       ▼
┌─────────────────────────────────────────────────┐
│              Inner Bot Server                   │
├─────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────┐ │
│  │ Main Server │  │ AI Service  │  │ Cronjob │ │
│  │             │  │             │  │         │ │
│  │ • 飞书集成   │  │ • 对话引擎   │  │ • 定时  │ │
│  │ • 规则处理   │  │ • 工具调用   │  │ • 下载  │ │
│  │ • 媒体处理   │  │ • 记忆管理   │  │ • 同步  │ │
│  └─────────────┘  └─────────────┘  └─────────┘ │
└─────────────────────────────────────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────┐
│              基础设施层                         │
├─────────────────────────────────────────────────┤
│ PostgreSQL  │ MongoDB  │ Redis  │ Elasticsearch │
└─────────────────────────────────────────────────┘
```

## 🎮 使用方法

在飞书群中@机器人并发送命令：

```
@机器人 你好           # 开始对话
@机器人 发图 二次元     # 搜索图片
@机器人 水群           # 查看统计
@机器人 帮助           # 功能帮助
```

## 📁 项目结构

```
inner_bot_server/
├── apps/
│   ├── main-server/      # Node.js 飞书机器人服务
│   │   ├── src/
│   │   │   ├── services/ # 业务逻辑
│   │   │   ├── dal/      # 数据访问
│   │   │   └── types/    # 类型定义
│   │   └── package.json
│   ├── ai-service/       # Python AI对话服务
│   │   ├── api/         # HTTP接口
│   │   ├── services/    # 核心服务
│   │   └── agents/      # AI代理
│   │   └── pyproject.toml
│   └── cronjob/         # 定时任务服务
│       ├── src/
│       │   ├── service/ # 业务逻辑
│       │   ├── mongo/   # MongoDB访问
│       │   └── pixiv/   # Pixiv集成
│       └── package.json
├── packages/            # 公共包
│   ├── ts-shared/       # TypeScript 公共模块 (@inner/shared)
│   └── py-shared/       # Python 公共模块 (inner-shared)
├── infra/              # 基础设施配置
│   ├── compose/        # Docker Compose文件
│   ├── redis/          # Redis配置
│   └── database/       # 数据库配置
├── docs/               # 文档
├── scripts/            # 部署脚本
└── Makefile           # 管理命令
```

## 📚 相关文档

- [部署指南](docs/deployment.md) - 详细部署和配置说明
- [健康检查](docs/health_check.md) - 自动监控和告警设置
- [自动部署](docs/auto_deploy.md) - 自动更新配置
- [Monorepo整合](docs/monorepo_integration.md) - 仓库整合说明

## 📄 许可证

MIT License

